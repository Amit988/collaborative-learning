
{% extends "qna/base.html" %}
{% load crispy_forms_tags %}
{% load cloudinary %}
{% load static %}
{% load humanize %}
{% block title %}
    {{club.name}}
{% endblock %}
{% block script %} 

  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.css" rel="stylesheet">
  
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>

  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

  <link href="https://unpkg.com/pattern.css" rel="stylesheet">

  <link rel="stylesheet" href="{% static 'accounts/css/style.css' %}">


  <script defer src="https://widget-js.cometchat.io/v3/cometchatwidget.js"></script>

  <script type="text/javascript" src="https://unpkg.com/@cometchat-pro/chat@3.0.3/CometChat.js"></script>


  <style type="text/css">
    
    .curved {
      position: relative;
      background: #2c3e50;
      height: 80vh;
    }

    .curved::after {
      content: '';
      border-top-left-radius: 50% 100%;
      border-top-right-radius: 50% 100%;
      position: absolute;
      bottom: 0;
      width: 100%;
      background: #f3f7f8;
      height: 20%;
    }

    .b-example-divider {
      height: 3rem;
      background-color: rgba(0, 0, 0, .1);
      border: solid rgba(0, 0, 0, .15);
      border-width: 1px 0;
      box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
    }

    .bi {
      vertical-align: -.125em;
      fill: currentColor;
    }

    .feature-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 4rem;
      height: 4rem;
      margin-bottom: 1rem;
      font-size: 2rem;
      color: #fff;
      border-radius: .75rem;
    }

    .icon-link {
      display: inline-flex;
      align-items: center;
    }
    .icon-link > .bi {
      margin-top: .125rem;
      margin-left: .125rem;
      transition: transform .25s ease-in-out;
      fill: currentColor;
    }
    .icon-link:hover > .bi {
      transform: translate(.25rem);
    }

    .icon-square {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 3rem;
      height: 3rem;
      font-size: 1.5rem;
      border-radius: .75rem;
    }

    .rounded-4 { border-radius: .5rem; }
    .rounded-5 { border-radius: 1rem; }

    .text-shadow-1 { text-shadow: 0 .125rem .25rem rgba(0, 0, 0, .25); }
    .text-shadow-2 { text-shadow: 0 .25rem .5rem rgba(0, 0, 0, .25); }
    .text-shadow-3 { text-shadow: 0 .5rem 1.5rem rgba(0, 0, 0, .25); }

    .card-cover {
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;
    }



    .filled {

        color: white;
        background-color: #46c3db;
        border: none;
        font-size: 13px;
        text-transform: uppercase;
        font-weight: 700;
        padding: 12px 30px;
        border-radius: 30px;
        display: inline-block;
        transition: all 0.3s;
        outline: none;
        box-shadow: none;
        text-shadow: none;
        cursor: pointer;
    }


    .filled:hover {
        background-color: #2d6cdf;
        color: white;
    }



/*
    #load{
        width:100%;
        height:100%;
        position:fixed;
        z-index:9999;
        background:url("{% static 'courses/787.gif' %}") no-repeat center center;
    }*/

  </style>

{% endblock script %}
{% block main %}


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">

  <symbol id="people-circle" viewBox="0 0 16 16">
    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
    <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
  </symbol>

  <symbol id="collection" viewBox="0 0 16 16">
    <path d="M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-11zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zm1.5.5A.5.5 0 0 1 1 13V6a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-13z"/>
  </symbol>


  <symbol id="chevron-right" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
  </symbol>

</svg>

<div class="container m-2">

  {% for msg in messages %}

      <div class="row">
          <p class="text-success text-center">{{msg}}</p>
      </div>
      
  {% endfor %}

</div>




<div id="load"></div>
<div class="container" id="cont">



  <div class="row flex-lg-row-reverse align-items-center g-5 py-5 text-dark">
    <div class="col-10 col-sm-8 col-lg-6">

      {% if club.logo == 'blank' %}

        <img src="{% static 'accounts/default.jpg' %}" class="d-block mx-lg-auto img-fluid" alt="Course Image" width="300" height="300" loading="lazy">
        

      {% else %}
        <img src="{{club.logo.url}}" class="d-block mx-lg-auto img-fluid" alt="Course Image" width="300" height="300" loading="lazy">

      {% endif %}
    </div>
    <div class="col-lg-6">
      <h1 class="display-5 fw-bold lh-1 mb-3">{{club.name}}: {{club.tagline}}</h1>

      {% if club.vision_and_mission %}
        <h6 class="lead">About: {{club.vision_and_mission}}</h6>

      {% else %}

        <h6 class="lead">About: We love to learn togehter!!</h6>

      {% endif %}

      {% if club.dateoffound %}
        <p class="text-muted">Found On :- {{club.dateoffound | naturalday}}</p>

      {% endif %}
      <div class="d-grid gap-2 d-md-flex justify-content-md-start">

        <span class="material-icons">
        share 
        </span>

        <a href="{% url 'view-club' club.id %}" class="text-decoration-none">Share your club!</a>
        <!--<button type="button" class="btn btn-primary btn-lg px-4 me-md-2">Primary</button>
        <button type="button" class="btn btn-outline-secondary btn-lg px-4">Default</button>-->


      </div>
    </div>
  </div>


  <div class="text-center mt-5">


    <a class="filled-button text-decoration-none mb-4" href="{% url 'stories' %}">
      Stories <span class="badge bg-success">New</span>
    </a>
    
  </div>


  <div class="row mt-2">


    <div class="px-4 py-5 my-5">
      
      <div class="text-dark text-center">


        <i class="fa fa-bullhorn" aria-hidden="true" style="font-size: 20px;"></i><h1 class="display-5 fw-bold text-center"><a href="{% url 'club-discussion' club.id %}" class="text-decoration-none text-dark">Announcements</a></h1>
        
      </div>

      
      <div class="col-lg-6 mx-auto">
        <p class="lead mb-4"></p>

        <div class="list-group mt-3">

          {% if club_discussion %}

            {% for i in club_discussion %}

              <a href="{% url 'task-chat' i.id club.id %}" class="list-group-item list-group-item-action" aria-current="true">
                <div class="d-flex w-100 justify-content-between">
                  <h5 class="mb-1">{{i.user.username}}</h5>
                  <small>{{i.time|naturaltime}}</small>
                </div>
                <p class="mb-1">{{i.msg|safe|truncatewords:15}}</p>
                <p class="mb-1">Views: {{i.taskviews.all|length}}</p>
                <!--<small>And some small print.</small> <a href="{% url 'task-chat' i.id club.id %}" class="text-success text-dark" style="text-decoration: none;"> -->
              </a>

            {% endfor %}

          {% else %}

            <h6 class="text-center mt-2 text-dark">No discussions yet.</h6>

          {% endif %}

        </div>

        <div class="d-grid gap-2 d-sm-flex justify-content-sm-center mt-5">

          <div class="text-center">

            <!--<a href="{% url 'club-discussion' club.id %}" class="filled-button text-decoration-none mb-4">Announce</a>-->


            <button class="filled-button text-decoration-none mb-4" data-bs-toggle = "modal" data-bs-target="#Backdrop">
              Announce
            </button>
            
          </div>

          <div class="text-center">


            <button class="filled text-decoration-none mb-4" data-bs-toggle="modal" data-bs-target="#static-Backdrop">
              Ask Doubts
            </button>
            
          </div>
          

        </div>
      </div>
    </div>



    <!-- Modal -->
    <div class="modal fade" id="static-Backdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header text-center">
            <h5 class="modal-title text-dark" id="staticBackdropLabel">Ask Doubts</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">

            <form class="p-4 p-md-5 border rounded-3 bg-light" action="{% url 'qna:add-question-view' club.id %}" enctype="multipart/form-data" method="post">

              {% csrf_token %}

              <div class="form-floating mb-3">
                <input type="text" id="defaultForm" class="form-control" name="title" required placeholder="title">
                <label data-error="wrong" data-success="right" for="defaultForm" class="text-dark">Title</label>
              </div>

              <div class="form-floating mb-3">

                <input type="text" id="floatingSelect" class="form-control text-dark" name="tag" required placeholder="web-development, front-end, HTML...">
                <label for="floatingSelect" class="text-dark">Tags(HTML, CSS, CP...)</label>

              </div>


              <div class= "mb-3 text-dark form-floating">

                
                <textarea id="summernote" name="details" class="form-control" required placeholder="details"></textarea>
                <!--<label data-error="wrong" data-success="right" for="summernote">Detailed Description</label>-->
                
              </div>


              <div class="text-center">
                <button type="submit" class="filled-button mb-5 mt-5">Ask</button>
              </div>

            </form>
            
          </div>
        </div>
      </div>
    </div>


    <div class="modal fade" id="Backdrop" data-bs-backdrop="Backdrop" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header text-center">
            <h5 class="modal-title text-dark" id="staticBackdropLabel">Announce</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">

            <form class="p-4 p-md-5 border rounded-3 bg-light" action="{% url 'taskform' %}" enctype="multipart/form-data" method="post">

              {% csrf_token %}

              <div class="form-floating mb-3">
                <input type="text" id="defaultForm" class="form-control" name="tag" placeholder="Title" required>
                <label data-error="wrong" data-success="right" for="defaultForm" class="text-dark">Title</label>
              </div>

              <div class="form-floating mb-3">

                <select class="form-select" aria-label="Default select example" name="club-name" id="floatingSelect">
                  {% for i in allclub %}
                    <option value="{{i.id}}"  class="text-dark">{{i.name}}</option>
                  {% endfor %}
                </select>
                <label for="floatingSelect">Club</label>

              </div>


              <div class= "mb-3 text-dark">

                <label data-error="wrong" data-success="right" for="summer">Detailed Description</label>
                <textarea id="summer" name="msg" class="form-control" required></textarea>
                
              </div>

              <div class="text-center">
                <button type="submit" class="filled-button mb-5 mt-5">Add</button>
              </div>

            </form>
            
          </div>
        </div>
      </div>
    </div>



  </div>

    <div class="row mt-3 mb-5">


      <div class="col text-dark m-3">
        <div class="feature-icon bg-dark">
          <svg class="bi" width="1em" height="1em"><use xlink:href="#people-circle"/></svg>
        </div>
        <h2>{{club.name}}'s Joint Secretary</h2>
        <hr>

        <div class="card">


          <div class="card-body">

            {% for i in jsecs %}

              <h5 class="card-title"><a href="{% url 'info' i.name.username %}" class="text-decoration-none text-dark">{{i.name.username}}</a></h5>
              <hr>
            {% endfor %}

            {% if members|length <= 1 %}
              <h6 class="card-subtitle mb-2 text-muted mt-3"><span class="badge bg-info">{{members|length}} Member</span></h6>

            {% else %}

              <h6 class="card-subtitle mb-2 text-muted mt-3"><span class="badge bg-info">{{members|length}} Members</span></h6>

            {% endif %}


            {% if  flag %}

              <a class="text-decoration-none btn btn-dark mt-3" href="{% url 'view-waitingarea' club.id %}">Manage Members <span class="badge bg-info text-dark">{{waiting_list}}</span></a>


            {% endif %}

            <a href="{% url 'Your-club_members' club.id %}" class="icon-link btn btn-dark mt-3">
              view all members
              <svg class="bi" width="1em" height="1em"><use xlink:href="#chevron-right"/></svg>
            </a>
          </div>


          
        </div>

      </div>

      <div class="col text-dark m-3">

        <div class="feature-icon bg-dark">
          <svg class="bi text-white" width="1em" height="1em"><use xlink:href="#collection"/></svg>
        </div>

        <h2>{{club.name}}'s Q&A</h2>
        <hr>
        <div class="card">


          <div class="card-body">

            {% for i in questions %}
              <p class="card-text"><a href="{% url 'qna:add-answere-view' i.id %}" class="text-dark text-decoration-none">{{i.title}}</a></p>
              <hr class="text-dark">
            {% endfor %}

            <a class="text-decoration-none btn btn-dark mt-3 icon-link" href="{% url 'qna:club-qna' club.id %}">view all<svg class="bi" width="1em" height="1em"><use xlink:href="#chevron-right"/></svg></a><br>

            <a class="text-danger mt-2" type="button" data-toggle="collapse" data-target="#deleteBox" aria-expanded="false" aria-controls="deleteBox">
            leave club
            </a>

            <div class="collapse" id="deleteBox">
                <div class="card card-body my-2 text-center">

                    <h5 class="card-title text-danger">Are you sure?</h5>
                    <a class="text-decoration-none" href="{% url 'leave-club' club.id %}">Yes</a>
                    
                </div>
            </div><br>


          </div>


          
        </div>


      </div>

    </div>


    <div class="modal fade" id="Backdrop" data-bs-backdrop="#Backdrop" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header text-center">
            <h5 class="modal-title text-dark" id="staticBackdropLabel">Report Club</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">

            <form class="p-4 p-md-5 border rounded-3 bg-light" action="{% url 'report-club' club.id %}" enctype="multipart/form-data" method="post">

              {% csrf_token %}

              <div class="form-floating mb-3">
                <textarea id="defaultForm" class="form-control" name="msg" required placeholder="title"></textarea>
                <label data-error="wrong" data-success="right" for="defaultForm" class="text-dark">What problems are you facing?</label>
              </div>


              <div class="text-center">
                <button type="submit" class="filled-button mb-5 mt-5">Send</button>
              </div>

            </form>
            
          </div>
        </div>
      </div>
    </div>

        <div class="text-center mb-4">


          <a class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#Backdrop" href="">
            Report Club
          </a>
          
        </div>



      <div class="container mb-5 text-center">

        <div class="row">

          <div class="col">

            <div id="cometchat"></div>
            
          </div>

        </div>
        
        
      </div>
       

      <script>
        $('#summer').summernote({
          placeholder: 'Details',
          tabsize: 2,
          height: 100,

        });
      </script>

      <script>
        $('#summernote').summernote({
          placeholder: 'Details',
          tabsize: 2,
          height: 100,

        });
      </script>

       <script type="text/javascript">


        window.addEventListener('DOMContentLoaded', (event) => {

            CometChatWidget.init({
              appID: '19851140fbfb68a7',
              appRegion: 'us',
              authKey: '7a3dee94e88d9757c7fb2dee2752db548402c37a',

            }).then((response) => {

              /**
               * Create user once initialization is successful
               */
              const user = new CometChatWidget.CometChat.User("{{request.user.id}}");
              user.setName("{{request.user.username}}");

              //user.setAvatar(AVATAR_URL);
              //user.setLink(PROFILE_LINK);

              CometChatWidget.createOrUpdateUser(user).then((user) => {

                // Proceed with user login
                CometChatWidget.login({

                  uid: "{{request.user.id}}",

                }).then((loggedInUser) => {


                  var groupType = CometChat.GROUP_TYPE.PUBLIC;
                  const group = new CometChatWidget.CometChat.Group("{{club.id}}", "{{club.name}}", groupType, "");
                  //group.setIcon(ICON_URL);
                  CometChatWidget.createOrUpdateGroup(group);

                  console.log(group)

                  let GUID = "{{club.id}}";
                  let UID =  "{{request.user.id}}";

                  let membersList = [
                    new CometChat.GroupMember(UID, CometChat.GROUP_MEMBER_SCOPE.PARTICIPANT)
                  ];

                  console.log(membersList)

                  CometChat.addMembersToGroup(GUID, membersList, []).then(
                    response => {
                      console.log("response", response);
                    }, error => {
                      console.log("Something went wrong", error);
                    }
                  );


                    CometChatWidget.launch({

                      // Embedded or docked layout configuration
                      "widgetID": "345d2de7-cf0b-4094-9500-9f7621865b9b",
                      "docked": "true",
                      "target": "#cometchat",
                      "roundedCorners": "true",
                      "height": "400px",
                      "width": "350px",
                      "defaultID": '{{club.id}}', //default UID (user) or GUID (group) to show,
                      "defaultType": 'group'



                    })

                });
              });
            });

          });
         
       </script>


  </div>



{% endblock main %}



{% block ajaxbox %}

<!--
  <script>

      const ele = document.getElementById("msg-container")
      setTimeout(function(){

          ele.style.display = "none";
          },
       3000);


        document.onreadystatechange = function () {
        var state = document.readyState
        if (state == 'interactive') {
             document.getElementById('cont').style.visibility="hidden";
        } else if (state == 'complete') {
            setTimeout(function(){
               document.getElementById('interactive');
               document.getElementById('load').style.visibility="hidden";
               document.getElementById('cont').style.visibility="visible";
            },1000);
        }
      }

  </script>-->


{% endblock %}
